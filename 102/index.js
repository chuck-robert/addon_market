/*QUIK_ADDON 1|翻译|1|1.0.0|随时翻译需要的文本，支持多种语言，安装后在主菜单中打开|siquan|https://image.gumengya.com/i/2024/09/16/66e7a31e382b5.png|https://siquan001.github.io/|version.txt|siquan.translate */
(()=>{console.log("fanyi模块加载成功"),quik.mainmenu.pushMenu({icon:util.getGoogleIcon("e8e2"),title:"翻译",click:()=>{i.open()}});var e={chinese_simplified:"简体中文",english:"英语",japanese:"日语",chinese_traditional:"繁體中文",french:"法语",italian:"意大利语",spanish:"西班牙语",arabic:"阿拉伯语",deutsch:"德语",korean:"韩语",turkish:"土耳其语",ukrainian:"乌克兰语",norwegian:"挪威",welsh:"威尔士语",dutch:"荷兰语",filipino:"菲律宾语",lao:"老挝语",telugu:"泰卢固语",romanian:"罗马尼亚语",nepali:"尼泊尔语",haitian_creole:"海地克里奥尔语",czech:"捷克语",swedish:"斯文斯卡语",russian:"俄语",malagasy:"马达加斯加语",burmese:"巴拉姆语",pashto:"普什图语",thai:"泰国语",armenian:"亚美尼亚语",persian:"波斯语",kurdish:"库尔德语",hindi:"印地语",bulgarian:"保加利亚语",malay:"马来语",swahili:"斯瓦希里语",oriya:"奥迪亚语",icelandic:"冰岛语",irish:"爱尔兰语",khmer:"高棉语",gujarati:"古吉拉特语",slovak:"斯洛伐克语",kannada:"卡纳达语",hebrew:"希伯来语",hungarian:"匈牙利语",marathi:"马拉地语",tamil:"泰米尔语",estonian:"爱沙尼亚语",malayalam:"马拉雅拉姆语",inuktitut:"印尼巽他语",slovene:"斯洛文尼亚语",bengali:"孟加拉语",urdu:"乌尔都语",azerbaijani:"阿塞拜疆语",portuguese:"葡萄牙语",samoan:"萨摩亚语",afrikaans:"南非语",tongan:"汤加语",greek:"希腊语",indonesian:"印度尼西亚语",danish:"丹麦语",amharic:"阿姆哈拉语",punjabi:"旁遮普语",albanian:"阿尔巴尼亚语",lithuanian:"立陶宛语",vietnamese:"越南语",maltese:"马耳他语",finnish:"芬兰语",catalan:"加泰罗尼亚语",croatian:"克罗地亚语",bosnian:"波斯尼亚语",polish:"波兰语",latvian:"拉脱维亚语",maori:"毛利语"},a={api:{auth:"https://edge.microsoft.com/translate/auth",translate:"https://api.cognitive.microsofttranslator.com/translate?from={from}&to={to}&api-version=3.0&includeSentenceLength=true"},language:{json:[{id:"ukrainian",name:"УкраїнськаName",serviceId:"uk"},{id:"norwegian",name:"Norge",serviceId:"no"},{id:"welsh",name:"color name",serviceId:"cy"},{id:"dutch",name:"nederlands",serviceId:"nl"},{id:"japanese",name:"しろうと",serviceId:"ja"},{id:"filipino",name:"Pilipino",serviceId:"fil"},{id:"english",name:"English",serviceId:"en"},{id:"lao",name:"ກະຣຸນາ",serviceId:"lo"},{id:"telugu",name:"తెలుగుQFontDatabase",serviceId:"te"},{id:"romanian",name:"Română",serviceId:"ro"},{id:"nepali",name:"नेपालीName",serviceId:"ne"},{id:"french",name:"Français",serviceId:"fr"},{id:"haitian_creole",name:"Kreyòl ayisyen",serviceId:"ht"},{id:"czech",name:"český",serviceId:"cs"},{id:"swedish",name:"Svenska",serviceId:"sv"},{id:"russian",name:"Русский язык",serviceId:"ru"},{id:"malagasy",name:"Malagasy",serviceId:"mg"},{id:"burmese",name:"ဗာရမ်",serviceId:"my"},{id:"pashto",name:"پښتوName",serviceId:"ps"},{id:"thai",name:"คนไทย",serviceId:"th"},{id:"armenian",name:"Արմենյան",serviceId:"hy"},{id:"chinese_simplified",name:"简体中文",serviceId:"zh-CHS"},{id:"persian",name:"Persian",serviceId:"fa"},{id:"chinese_traditional",name:"繁體中文",serviceId:"zh-CHT"},{id:"kurdish",name:"Kurdî",serviceId:"ku"},{id:"turkish",name:"Türkçe",serviceId:"tr"},{id:"hindi",name:"हिन्दी",serviceId:"hi"},{id:"bulgarian",name:"български",serviceId:"bg"},{id:"malay",name:"Malay",serviceId:"ms"},{id:"swahili",name:"Kiswahili",serviceId:"sw"},{id:"oriya",name:"ଓଡିଆ",serviceId:"or"},{id:"icelandic",name:"ÍslandName",serviceId:"is"},{id:"irish",name:"Íris",serviceId:"ga"},{id:"khmer",name:"ខ្មែរKCharselect unicode block name",serviceId:"km"},{id:"gujarati",name:"ગુજરાતી",serviceId:"gu"},{id:"slovak",name:"Slovenská",serviceId:"sk"},{id:"kannada",name:"ಕನ್ನಡ್Name",serviceId:"kn"},{id:"hebrew",name:"היברית",serviceId:"he"},{id:"hungarian",name:"magyar",serviceId:"hu"},{id:"marathi",name:"मराठीName",serviceId:"mr"},{id:"tamil",name:"தாமில்",serviceId:"ta"},{id:"estonian",name:"eesti keel",serviceId:"et"},{id:"malayalam",name:"മലമാലം",serviceId:"ml"},{id:"inuktitut",name:"ᐃᓄᒃᑎᑐᑦ",serviceId:"iu"},{id:"arabic",name:"بالعربية",serviceId:"ar"},{id:"deutsch",name:"Deutsch",serviceId:"de"},{id:"slovene",name:"slovenščina",serviceId:"sl"},{id:"bengali",name:"বেঙ্গালী",serviceId:"bn"},{id:"urdu",name:"اوردو",serviceId:"ur"},{id:"azerbaijani",name:"azerbaijani",serviceId:"az"},{id:"portuguese",name:"português",serviceId:"pt"},{id:"samoan",name:"lifiava",serviceId:"sm"},{id:"afrikaans",name:"afrikaans",serviceId:"af"},{id:"tongan",name:"汤加语",serviceId:"to"},{id:"greek",name:"ελληνικά",serviceId:"el"},{id:"indonesian",name:"IndonesiaName",serviceId:"id"},{id:"spanish",name:"Español",serviceId:"es"},{id:"danish",name:"dansk",serviceId:"da"},{id:"amharic",name:"amharic",serviceId:"am"},{id:"punjabi",name:"ਪੰਜਾਬੀName",serviceId:"pa"},{id:"albanian",name:"albanian",serviceId:"sq"},{id:"lithuanian",name:"Lietuva",serviceId:"lt"},{id:"italian",name:"italiano",serviceId:"it"},{id:"vietnamese",name:"Tiếng Việt",serviceId:"vi"},{id:"korean",name:"한국어",serviceId:"ko"},{id:"maltese",name:"Malti",serviceId:"mt"},{id:"finnish",name:"suomi",serviceId:"fi"},{id:"catalan",name:"català",serviceId:"ca"},{id:"croatian",name:"hrvatski",serviceId:"hr"},{id:"bosnian",name:"bosnian",serviceId:"bs-Latn"},{id:"polish",name:"Polski",serviceId:"pl"},{id:"latvian",name:"latviešu",serviceId:"lv"},{id:"maori",name:"Maori",serviceId:"mi"}],map:void 0,getMap:function(){if(void 0===a.language.map){a.language.map=new Array;for(var e=0;e<a.language.json.length;e++){var i=a.language.json[e];a.language.map[i.id]=i.serviceId}}return a.language.map}},translate:function(e,i){var n=e.text;let t=a.split(n,48e3);a.send(a.api.auth,{},(function(n){for(var s=a.language.getMap()[e.from],r=a.language.getMap()[e.to],l=a.api.translate.replace("{from}",s).replace("{to}",r),d=0;d<t.length;d++){for(var o=[],c=0;c<t[d].length;c++)o.push({Text:t[d][c]});a.send(l,JSON.stringify(o),(function(a){var n={info:"SUCCESS",result:1};n.from=e.from,n.to=e.to,n.text=[];for(var s=0;s<a.length;s++)n.text.push(a[s].translations[0].text);if(t.length>1){for(var r=-1,l=0;l<t.length;l++)if(t[l].length-n.text.length==0){r=l;break}r<0&&(console.log("------ERROR--------"),console.log("翻译内容过多，进行拆分，但拆分判断出现异常，currentIndex：-1 请联系 http://translate.zvo.cn/43006.html 说明"));for(var d=0;d<r;d++)for(var o=t[d].length,c=0;c<o;c++)n.text.unshift(null);for(var h=t.length-1;h>r;h--){var u=t[h].length;for(c=0;c<u;c++)n.text.push(null)}}i(n)}),"post",!0,{Authorization:"Bearer "+n,"Content-Type":"application/json"},(function(e){console.log("---------error--------"),console.log("edge translate service error, http code : "+e.status+", response text : "+e.responseText)}),!0)}}),"get",!0,{"content-type":"application/x-www-form-urlencoded"},(function(e){console.log("---------error--------"),console.log("edge translate service error, http code : "+e.status+", response text : "+e.responseText),i(!1)}),!0)},send:function(e,a,i,n,t,s,r){var l="";if(null!=a&&void 0!==a||(a={}),"string"==typeof a)l=a;else for(var d in a)l.length>0&&(l+="&"),l=l+d+"="+a[d];var o=null;try{o=new XMLHttpRequest}catch(e){o=new ActiveXObject("Microsoft.XMLHTTP")}if(o.open(n,e,t),null!=s)for(var d in s)o.setRequestHeader(d,s[d]);return o.send(l),o.onreadystatechange=function(){if(4==o.readyState)if(200==o.status){var e=null;if(void 0===o.responseText||null==o.responseText);else if(o.responseText.indexOf("{")>-1&&o.responseText.indexOf("}")>-1)try{e=JSON.parse(o.responseText)}catch(e){console.log(e)}i(null==e?o.responseText:e)}else r(o)},o},split:function(e,a){let i=[];if(JSON.stringify(e).length<=a)i.push(e);else{let n=JSON.stringify(e).trim().substring(1,JSON.stringify(e).length-1);if(JSON.stringify(e).length-a<=2){a-=4;let e=n.substring(0,n.lastIndexOf('","')+1),t=n.substring(n.lastIndexOf('","')+2);i.push(JSON.parse("["+e+"]")),i.push(JSON.parse("["+t+"]"))}else{a-=2;let e=0;for(;e-n.length<0;){let t="";t=e+a-n.length>=0?n.substring(e):n.substring(e,e+a);let s=t.length,r=1;if(t.endsWith('"')){if(t.endsWith('","'))s-=2;else if(!t.startsWith('"')){s=t.lastIndexOf('","')+1}}else if(t.endsWith('",'))s-=1;else{s=t.lastIndexOf('","')+1,s<=0&&(s=t.startsWith('"')?t.length()-1:t.length()-2,t.endsWith('"')||(r=0))}let l="";s-t.length>0||s-0==0?(l=t,s+=l.length):l=t.substring(0,s),l.startsWith('"')||l.startsWith(',"')||(l='"'+l),l.endsWith('"')||(l+='"'),e+=s+r,l="["+l+"]";try{i.push(JSON.parse(l))}catch(a){e=e-(s+r)+1}}}}return i}},i=new quik.dialog({content:'<div class="actionbar"><h1>翻译</h1><div class="closeBtn">[x]</div></div><div class="content"><div class="langselect"><select class="langfrom"></select> <span>-></span> <select class="langto"></select></div><div class="langtrans"><div class="input"><textarea class="langinput" placeholder="输入待翻译内容"></textarea></div><div class="output"><textarea class="langoutput" readonly="readonly"></textarea></div></div><div class="statu"></div></div>'.replace("[x]",util.getGoogleIcon("e5cd")).replace("->",util.getGoogleIcon("e941")),class:"trans-dialog",mobileShowtype:quik.dialog.SHOW_TYPE_FULLSCREEN}),n=i.getDialogDom();util.query(n,".closeBtn").onclick=function(){i.close()};var t=util.query(n,".langfrom"),s=util.query(n,".langto"),r="";for(var l in e)r+='<option value="'+l+'">'+e[l]+"</option>";t.innerHTML=s.innerHTML=r,t.value="english",s.value="chinese_simplified";var d=t.value,o=s.value;t.onchange=function(){this.value==o&&(o=d,s.value=d),d=this.value,g()},s.onchange=function(){this.value==d&&(d=o,t.value=o),o=this.value,g()};var c=util.query(n,"textarea.langinput"),h=util.query(n,"textarea.langoutput"),u=util.query(n,".statu");function g(){""!=c.value.trim()?(a.translate({text:[c.value.trim()],from:d,to:o},(function(e){if(!e)return u.innerHTML="翻译失败(网络错误)",void(h.value="");u.innerHTML="翻译完成",h.value=e.text.join("\n")})),u.innerHTML="翻译中..."):h.value=""}c.oninput=util.fangdou(g,500),util.addStyle(".d-c.trans-dialog{width:600px;height:500px;padding:0;overflow:hidden}.trans-dialog .content{width:calc(100% - 20px);height:calc(100% - 70px);overflow:hidden}.trans-dialog .content .langselect{width:100%;height:50px;overflow:hidden;font-size:20px;line-height:50px;text-align:center}.trans-dialog .content .langtrans{width:100%;height:calc(100% - 80px);overflow:hidden}.trans-dialog .content .langtrans>div{width:50%;height:100%;float:left}.trans-dialog .content .langtrans .input{background-color:#f5f5f5;border-color:#ccc;border-style:solid;border-width:0;border-right-width:1px;width:calc(50% - 1px)}.trans-dialog .content .langtrans .output{background-color:#f8f8f8}.trans-dialog .content .langtrans textarea{padding:10px;width:calc(100% - 20px);height:calc(100% - 20px);border:none;resize:none;background-color:transparent;font-family:'sans-serif';outline:0}@media (min-width:1000px){.d-c.trans-dialog{width:800px}}@media (min-width:1400px){.d-c.trans-dialog{width:900px}}@media (min-height:800px){.d-c.trans-dialog{height:600px}}@media (min-height:1000px){.d-c.trans-dialog{height:800px}}@media (max-width:600px){.dialog.mobile-show-full.show .d-c.trans-dialog{width:100%;height:100%}.trans-dialog .content .langtrans>div{width:100%;height:50%}.trans-dialog .content .langtrans .input{border-bottom-width:1px;height:calc(50% - 1px);width:100%;border-right-width:0}}body.dark .trans-dialog .content .langtrans .input{background-color:#444;border-color:#666}body.dark .trans-dialog .content .langtrans .output{background-color:#424242}")})();